USE MADHU
--CREATING ITEMS TABLE
CREATE TABLE ITEMS(ITNO INT PRIMARY KEY,ITNAME VARCHAR NOT NULL,TYPE CHAR(1) check in('n','r','c','o'),FEES SMALLMONEY NOT NULL)
INSERT INTO ITEMS VALUES(101,'nuts','n',100)
INSERT INTO ITEMS VALUES(102,'rice','r',200)
INSERT INTO ITEMS VALUES(103,'cosemetics','c',300)
INSERT INTO ITEMS VALUES(104,'others','o',20)
INSERT INTO ITEMS VALUES(105,'rice','r',500)
SELECT * FROM ITEMS
--CREATING SHOPS TABLE
CREATE TABLE SHOPS(SID INT PRIMARY KEY,SNAME VARCHAR(10)NOT NULL,LOCATION VARCHAR(10)NOT NULL)
INSERT INTO SHOPS VALUES(1,'AMB','WGL')
INSERT INTO SHOPS VALUES(2,'KSM','HNK')
INSERT INTO SHOPS VALUES(3,'MNG','KZP')
INSERT INTO SHOPS VALUES(4,'ABC','HYD')
INSERT INTO SHOPS VALUES(5,'DEF','KNR')
SELECT * FROM SHOPS
--CREATING CUSTOMERS TABLE
CREATE TABLE CUSTOMERS1(CID INT PRIMARY KEY,ITNO INT FOREIGN KEY REFERENCES ITEMS(ITNO),SID INT FOREIGN KEY REFERENCES SHOPS(SID),CNAME VARCHAR NOT NULL)
INSERT INTO CUSTOMERS1 VALUES(10,101,01,'MADHU')
--LIST ITEMS,SHOPS,CUSTOMER DETAILS WITH CROSS PRODUCT
SELECT * FROM ITEMS,SHOPS,CUSTOMERS
--MAKE A CURSOR TO GET ALL ITEMS DETAILS
DECLARE C1 CURSOR FOR SELECT ITNO,ITNAME,TYPE,FEES FROM ITEMS
DECLARE @ITNO INT,
--ADD THE NEW COLUMN EMAIL INTO CUSTOMERS TABLE USING DYNAMIC QUERIES?
CREATE PROC CUS(@TN VARCHAR(10))
AS 
BEGIN
EXEC('ALTER TABLE'+'@TN'+('ADD COLUMN EMAIL'))
END
--9)TO PERFORM ALL SET OPERATORS USING CUSTOMERS,ITEMS TABLE?
SELECT ITNO FROM CUSTOMERS UNION SELECT ITNO FROM ITEMS
SELECT ITNO FROM CUSTOMERS UNION ALL SELECT ITNO FROM ITEMS
SELECT ITNO FROM CUSTOMERS INTERSECT SELECT ITNO FROM ITEMS
SELECT CNAME FROM CUSTOMERS EXCEPT SELECT ITNAME FROM  ITEMS
--10)TO MAKE COMPLEX VIEW ON CUSTOMERS,SHOPS TABLE?
CREATE VIEW CUSTOMERS_SHOPS_VIEW AS SELECT CUSTOMERS.CID,CUSTOMERS.SID,CUSTOMERS.CNAME,SHOPS.SID,SHOPS.SNAME,SHOPS.LOCATION FROM CUSTOMERS.SID=SHOPS.SID
SELECT * FROM CUSTOMERS_SHOPS_VIEW